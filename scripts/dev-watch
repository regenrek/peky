#!/usr/bin/env bash
set -euo pipefail

if [[ ${1:-} == "-h" || ${1:-} == "--help" ]]; then
  cat <<'USAGE'
Usage: scripts/dev-watch [flags] [-- args...]

Hot-reload peakypanes on file changes using the in-repo watcher.
Pass any args after -- to forward to peakypanes.

Examples:
  scripts/dev-watch
  scripts/dev-watch -- --layout dev-3
  scripts/dev-watch --watch cmd,internal -- --layout dev-3
USAGE
  exit 0
fi

bin=${DEVWATCH_BIN:-./devwatch}
go build -o "$bin" ./cmd/devwatch
exec "$bin" "$@"
